import { useCustomizer } from "@lib/context/customizer-context";
import { useEffect, useRef, useState } from "react";
import Datepicker from "react-tailwindcss-datepicker";
import { formatDate } from "../../../../lib/util/format";

const DateInput = ({ }) => {
  const { current, setCurrent, addChange, currency, currentLayer } = useCustomizer()
  const ref = useRef();


  const [value, setValue] = useState<any>({
    startDate: null,
    endDate: null
  });
  useEffect(() => {
    if (current.fightDate) {
      setValue({
        startDate: current.fightDate,
        endDate: current.fightDate,
      })
    }
  }, [current])

  const onChange = (newValue: any) => {
    var date = new Date(newValue.startDate);
    setValue(newValue);
    setCurrent({ ...current, fightDate: date });
    addChange({
      id: currentLayer?.id ?? 'date',
      name: formatDate(date),
      layer_name: currentLayer?.name ?? 'date',
      image_url: '',
      price: 0,
      currency,
    })
  }

  return <div className="">
    <div className="border-2 rounded flex items-center">
      <Datepicker
        asSingle={true}
        value={value}
        inputClassName={'bg-c-black p-2 text-white w-full outline-none'}
        ref={ref}
        useRange={false}
        onChange={onChange}
      />
    </div>
  </div >;
}


export default DateInput;

export const ArrowIcon = ({ ...attributes }) => {
  return <svg {...attributes} width="13" height="7" viewBox="0 0 13 7" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M6.5 5.15712L1.13313 0.0872344C1.00996 -0.0291186 0.810255 -0.0291186 0.687127 0.0872345L0.0923877 0.649019C0.0332207 0.704872 -2.71854e-07 0.780666 -2.68401e-07 0.859679C-2.64947e-07 0.938691 0.0332207 1.01448 0.0923877 1.07034L6.277 6.9127C6.40017 7.02906 6.59987 7.02906 6.723 6.9127L12.9076 1.07038C12.9668 1.01452 13 0.93873 13 0.859717C13 0.780705 12.9668 0.704911 12.9076 0.649058L12.3129 0.087274C12.1897 -0.029079 11.99 -0.029079 11.8669 0.087274L6.5 5.15712Z" fill="white" />
  </svg>

}

const DatePickerIcon = () => {
  return <svg width="23" height="22" viewBox="0 0 23 22" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M20.6298 2.05815L15.1237 2.05817V0.687661C15.1237 0.307728 14.816 0 14.4361 0C14.0561 0 13.7484 0.307728 13.7484 0.687661V2.05783H8.24712V0.687661C8.24712 0.307728 7.93939 0 7.55946 0C7.17953 0 6.8718 0.307728 6.8718 0.687661V2.05783H1.37532C0.615801 2.05783 0 2.67363 0 3.43315V20.6247C0 21.3842 0.615801 22 1.37532 22H20.6298C21.3894 22 22.0052 21.3842 22.0052 20.6247V3.43315C22.0052 2.67395 21.3894 2.05815 20.6298 2.05815ZM20.6298 20.6247H1.37532V3.43315H6.8718V4.12597C6.8718 4.50588 7.17953 4.81363 7.55946 4.81363C7.93939 4.81363 8.24712 4.50588 8.24712 4.12597V3.43349H13.7484V4.12631C13.7484 4.50624 14.0561 4.81397 14.4361 4.81397C14.816 4.81397 15.1237 4.50624 15.1237 4.12631V3.43349H20.6298V20.6247ZM15.8162 10.9977H17.1915C17.5711 10.9977 17.8792 10.6897 17.8792 10.3101V8.93476C17.8792 8.55517 17.5711 8.2471 17.1915 8.2471H15.8162C15.4366 8.2471 15.1285 8.55517 15.1285 8.93476V10.3101C15.1285 10.6897 15.4366 10.9977 15.8162 10.9977ZM15.8162 16.4987H17.1915C17.5711 16.4987 17.8792 16.191 17.8792 15.811V14.4357C17.8792 14.0561 17.5711 13.748 17.1915 13.748H15.8162C15.4366 13.748 15.1285 14.0561 15.1285 14.4357V15.811C15.1285 16.1913 15.4366 16.4987 15.8162 16.4987ZM11.6902 13.748H10.3149C9.93533 13.748 9.62726 14.0561 9.62726 14.4357V15.811C9.62726 16.191 9.93533 16.4987 10.3149 16.4987H11.6902C12.0698 16.4987 12.3779 16.191 12.3779 15.811V14.4357C12.3779 14.0565 12.0698 13.748 11.6902 13.748ZM11.6902 8.2471H10.3149C9.93533 8.2471 9.62726 8.55517 9.62726 8.93476V10.3101C9.62726 10.6897 9.93533 10.9977 10.3149 10.9977H11.6902C12.0698 10.9977 12.3779 10.6897 12.3779 10.3101V8.93476C12.3779 8.55483 12.0698 8.2471 11.6902 8.2471ZM6.18895 8.2471H4.81363C4.43404 8.2471 4.12597 8.55517 4.12597 8.93476V10.3101C4.12597 10.6897 4.43404 10.9977 4.81363 10.9977H6.18895C6.56854 10.9977 6.87661 10.6897 6.87661 10.3101V8.93476C6.87661 8.55483 6.56854 8.2471 6.18895 8.2471ZM6.18895 13.748H4.81363C4.43404 13.748 4.12597 14.0561 4.12597 14.4357V15.811C4.12597 16.191 4.43404 16.4987 4.81363 16.4987H6.18895C6.56854 16.4987 6.87661 16.191 6.87661 15.811V14.4357C6.87661 14.0565 6.56854 13.748 6.18895 13.748Z" fill="black" />
  </svg>

}